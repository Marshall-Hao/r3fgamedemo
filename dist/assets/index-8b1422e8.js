import{j as K,r as d,u as x,C as V,B as J,M as j,F as U,T as $,E as X,R as S,a as Y,b as Z,Q as _,c as ee,s as te,V as A,d as b,e as re,f as ae,g as oe,D as se,P as ne,h as ie,i as ce,K as le,k as ue}from"./vendor-7093fd34.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&u(n)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const M=K.Fragment,e=K.jsx,c=K.jsxs;function de(){const t=d.useRef();return x(r=>{t.current.position.z=r.camera.position.z+1-4,t.current.target.position.z=r.camera.position.z-4,t.current.target.updateMatrixWorld()}),c(M,{children:[e("directionalLight",{ref:t,castShadow:!0,position:[4,4,1],intensity:1.5,"shadow-mapSize":[1024,1024],"shadow-camera-near":1,"shadow-camera-far":10,"shadow-camera-top":10,"shadow-camera-right":10,"shadow-camera-bottom":-10,"shadow-camera-left":-10}),e("ambientLight",{intensity:.5})]})}V.legacyMode=!1;const f=new J(1,1,1),G=new j({color:"#111111",metalness:0,roughness:0}),I=new j({color:"#222222",metalness:0,roughness:0}),D=new j({color:"#ff0000",metalness:0,roughness:1}),L=new j({color:"#887777",metalness:0,roughness:0});function me({position:t=[0,0,0]}){return c("group",{position:t,children:[e(U,{floatIntensity:.25,rotationIntensity:.25,children:c($,{font:"/bebas-neue-v9-latin-regular.woff",scale:.3,maxWidth:.25,lineHeight:.75,textAlign:"right",position:[.75,.65,0],"rotation-y":-.25,children:["Marshall Race",e("meshBasicMaterial",{toneMapped:!1})]})}),e("mesh",{position:[0,-.1,0],receiveShadow:!0,geometry:f,scale:[4,.2,4],material:G})]})}function he({position:t=[0,0,0]}){const r=d.useRef(),[s]=d.useState(()=>(Math.random()+.2)*(Math.random()<.5?-1:1));return x(u=>{var n;const a=u.clock.elapsedTime,o=new _;o.setFromEuler(new X(0,a*s,0)),(n=r.current)==null||n.setNextKinematicRotation(o)}),c("group",{position:t,children:[e("mesh",{position:[0,-.1,0],receiveShadow:!0,geometry:f,scale:[4,.2,4],material:I}),e(S,{type:"kinematicPosition",position:[0,.3,0],restitution:.2,friction:0,ref:r,children:e("mesh",{geometry:f,material:D,scale:[3.5,.3,.3],castShadow:!0})})]})}function fe({position:t=[0,0,0]}){const r=d.useRef(),[s]=d.useState(()=>(Math.random()+.2)*Math.PI*2);return x(u=>{var n;const a=u.clock.elapsedTime,o=Math.sin(a+s)+1.15;(n=r.current)==null||n.setNextKinematicTranslation({x:t[0],y:t[1]+o,z:t[2]})}),c("group",{position:t,children:[e("mesh",{position:[0,-.1,0],receiveShadow:!0,geometry:f,scale:[4,.2,4],material:I}),e(S,{type:"kinematicPosition",position:[0,.3,0],restitution:.2,friction:0,ref:r,children:e("mesh",{castShadow:!0,geometry:f,material:D,scale:[3.5,.3,.3]})})]})}function pe({position:t=[0,0,0]}){const r=d.useRef(),[s]=d.useState(()=>(Math.random()+.2)*Math.PI*2);return x(u=>{var n;const a=u.clock.elapsedTime,o=Math.sin(a+s)+.25;(n=r.current)==null||n.setNextKinematicTranslation({x:t[0]+o,y:t[1]+.75,z:t[2]})}),c("group",{position:t,children:[e("mesh",{position:[0,-.1,0],receiveShadow:!0,geometry:f,scale:[4,.2,4],material:I}),e(S,{type:"kinematicPosition",position:[0,.3,0],restitution:.2,friction:0,ref:r,children:e("mesh",{castShadow:!0,geometry:f,material:D,scale:[1.5,1.5,.3]})})]})}function ye({position:t=[0,0,0]}){const r=Y("/hamburger.glb");return r.scene.children.forEach(s=>{s.castShadow=!0}),c("group",{position:t,children:[c($,{font:"/bebas-neue-v9-latin-regular.woff",scale:.3,position:[0,2.25,2],children:["FINISH",e("meshBasicMaterial",{toneMapped:!1})]}),e("mesh",{position:[0,-.1,0],receiveShadow:!0,geometry:f,scale:[4,.2,4],material:G}),e(S,{type:"fixed",colliders:"hull",position:[0,.25,0],restitution:.3,children:e("primitive",{object:r.scene,scale:.2})})]})}function ge({length:t=1}){return e(M,{children:c(S,{type:"fixed",restitution:.2,friction:0,children:[e("mesh",{position:[2.15,.75,-(t*2)+2],geometry:f,material:L,scale:[.3,1.5,4*t],castShadow:!0}),e("mesh",{position:[-2.15,.75,-(t*2)+2],geometry:f,material:L,scale:[.3,1.5,4*t],receiveShadow:!0}),e("mesh",{position:[0,.75,-(t*4)+2],geometry:f,material:L,scale:[4,1.5,.3],receiveShadow:!0}),e(Z,{args:[2,.1,2*t],position:[0,-.1,-(t*2)+2],restitution:.2,friction:1})]})})}function we({count:t=5,types:r=[he,pe,fe],seed:s=0}){const u=d.useMemo(()=>{const a=[];for(let o=0;o<t;o++){const n=r[Math.floor(Math.random()*r.length)];a.push(n)}return a},[t,r,s]);return c(M,{children:[e(me,{position:[0,0,0]}),u.map((a,o)=>e(a,{position:[0,0,-(o+1)*4]},o)),e(ye,{position:[0,0,-(t+1)*4]}),e(ge,{length:t+2})]})}const p=ee(te(t=>({blockCount:10,phase:"ready",blockSeed:0,startTime:0,endTime:0,start:()=>{t(r=>r.phase==="ready"?{phase:"playing",startTime:Date.now()}:{})},restart:()=>{t(r=>r.phase==="playing"||r.phase==="ended"?{phase:"ready",blockSeed:Math.random()}:{})},end:()=>{t(r=>r.phase==="playing"?{phase:"ended",endTime:Date.now()}:{})}})));function be(){const[t]=d.useState(()=>new A(10,10,10)),[r]=d.useState(()=>new A),s=d.useRef(),[u,a]=b(),{rapier:o,world:n}=re(),T=n.raw(),l=p(i=>i.start),w=p(i=>i.end),y=p(i=>i.restart),q=p(i=>i.blockCount),H=()=>{var z,N;const i=(z=s.current)==null?void 0:z.translation();i.y-=.31;const h={x:0,y:-1,z:0},g=new o.Ray(i,h),m=T.castRay(g,10,!0);(m==null?void 0:m.toi)<.15&&((N=s.current)==null||N.applyImpulse({x:0,y:.5,z:0},!0))},Q=()=>{var i,h,g;(i=s.current)==null||i.setTranslation({x:0,y:1,z:0}),(h=s.current)==null||h.setLinvel({x:0,y:0,z:0}),(g=s.current)==null||g.setAngvel({x:0,y:0,z:0})};return d.useEffect(()=>{const i=p.subscribe(m=>m.phase,m=>{m==="ready"&&Q()}),h=u(m=>m.jump,m=>{m&&H()}),g=u(()=>{l()});return()=>{h(),g(),i()}},[]),x((i,h)=>{var F,O,W;const{forward:g,backward:m,leftward:z,rightward:N,jump:xe}=a(),k={x:0,y:0,z:0},v={x:0,y:0,z:0},R=.6*h,C=.2*h;g&&(k.z-=R,v.x-=C),N&&(k.x+=R,v.z-=C),m&&(k.z+=R,v.x+=C),z&&(k.x-=R,v.z+=C),(F=s.current)==null||F.applyImpulse(k,!0),(O=s.current)==null||O.applyTorqueImpulse(v,!0);const P=(W=s.current)==null?void 0:W.translation(),E=new A;E.copy(P),E.z+=2.25,E.y+=.65;const B=new A;B.copy(P),B.y+=.25,t.lerp(E,5*h),r.lerp(B,5*h),i.camera.position.copy(t),i.camera.lookAt(r),P.z<-(q*4+2)&&w(),P.y<-4&&y()}),e(S,{position:[0,1,0],colliders:"ball",restitution:.2,friction:1,linearDamping:.5,angularDamping:.5,ref:s,children:c("mesh",{children:[e("icosahedronGeometry",{args:[.3,1]}),e("meshStandardMaterial",{flatShading:!0,color:"mediumpurple"})]})})}function Se(){return e(M,{children:c(ae,{disableNormalPass:!0,children:[e(oe,{mipmapBlur:!0,intensity:.6,luminanceThreshold:0}),e(se,{focusDistance:.03,focalLength:.07,bokehScale:8})]})})}function ke(){const t=p(s=>s.blockCount),r=p(s=>s.blockSeed);return console.log(t),c(M,{children:[e("color",{args:["#252731"],attach:"background"}),c(ne,{children:[e(de,{}),e(we,{count:t,seed:r}),e(be,{})]}),e(Se,{})]})}function ve(){const t=p(l=>l.restart),r=p(l=>l.phase),s=b(l=>l.forward),u=b(l=>l.backward),a=b(l=>l.leftward),o=b(l=>l.rightward),n=b(l=>l.jump),T=d.useRef();return d.useEffect(()=>{const l=ie(()=>{const w=p.getState();let y=0;w.phase==="playing"?y=Date.now()-w.startTime:w.phase==="ended"&&(y=w.endTime-w.startTime),y/=1e3,y=y.toFixed(2),T.current.textContent=y});return()=>{l()}},[]),c("div",{className:"interface",children:[e("div",{className:"time",ref:T,children:"0.00"}),r==="ended"&&e("div",{className:"restart",onClick:t,children:"Restart"}),c("div",{className:"controls",children:[e("div",{className:"raw",children:e("div",{className:`key ${s?"active":""}`,children:"W"})}),c("div",{className:"raw",children:[e("div",{className:`key ${a?"active":""}`,children:"A"}),e("div",{className:`key ${u?"active":""}`,children:"S"}),e("div",{className:`key ${o?"active":""}`,children:"D"})]}),e("div",{className:"raw",children:e("div",{className:`key large ${n?"active":""}`,children:"SPACE"})})]})]})}ce.createRoot(document.getElementById("root")).render(c(le,{map:[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"backward",keys:["ArrowDown","KeyS"]},{name:"leftward",keys:["ArrowLeft","KeyA"]},{name:"rightward",keys:["ArrowRight","KeyD"]},{name:"jump",keys:["Space"]}],children:[e(ue,{camera:{fov:45,near:.1,far:2e3,position:[0,6.5,16]},shadows:!0,children:e(ke,{})}),e(ve,{})]}));
